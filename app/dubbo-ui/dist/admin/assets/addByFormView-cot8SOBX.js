import{u as Ue}from"./index-76iqyuzG.js";import{d as we,l as Re,m as De,Q as Ke,s as Q,g as qe,b as Oe,n as W,r as Se,w as le,f as F,c as e,t as l,e as K,o as v,z as g,v as _,h as j,a6 as je,a7 as Ee,K as O,F as L,y as X,J as G,B as E,I as A,G as Ae,H as ze,_ as Ve}from"./index-2tg1dFrv.js";import{a as Be}from"./traffic-uK9CJKqJ.js";import"./request-2UPhfKnX.js";const J=Y=>(Ae("data-v-86523a1c"),Y=Y(),ze(),Y),Ge={class:"__container_routingRule_detail"},me={style:{"max-width":"400px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}},Ne=J(()=>G("br",null,null,-1)),Pe=J(()=>G("br",null,null,-1)),We=J(()=>G("br",null,null,-1)),xe=J(()=>G("br",null,null,-1)),Fe=J(()=>G("br",null,null,-1)),Je=J(()=>G("br",null,null,-1)),Le=we({__name:"addByFormView",setup(Y){const m=Re(De.PROVIDE_INJECT_KEY);Ke(()=>{if(!Q.isNil(m.conditionRule)){const{enabled:s=!0,key:t,scope:i,runtime:h=!0,conditions:$}=m.conditionRule;C.enable=s,C.objectOfAction=t,C.ruleGranularity=i,C.runtime=h,$&&$.length&&$.forEach((r,n)=>{var f,q;const k=r.split("=>"),o=(f=k[0])==null?void 0:f.trim(),M=(q=k[1])==null?void 0:q.trim();d.value[n].requestMatch=$e(o,n),d.value[n].routeDistribute=Te(M,n)})}}),qe();const ae=Oe(),x=W(!1),Z=W(8);Ue().toClipboard;const C=Se({version:"",ruleGranularity:"",objectOfAction:"",enable:!0,faultTolerantProtection:!1,runtime:!0,priority:null,group:""});le(C,s=>{const{ruleGranularity:t,enable:i=!0,runtime:h=!0,objectOfAction:$}=s;m.conditionRule={...m.conditionRule,enabled:i,key:$,runtime:h,scope:t}},{immediate:!!Q.isNil(m.conditionRule)});const ne=W([{label:"host",value:"host"},{label:"application",value:"application"},{label:"method",value:"method"},{label:"arguments",value:"arguments"},{label:"attachments",value:"attachments"},{label:"其他",value:"other"}]),se=W([{label:"host",value:"host"},{label:"其他",value:"other"}]),N=W([{label:"=",value:"="},{label:"!=",value:"!="}]),oe=W([{label:"应用",value:"application"},{label:"服务",value:"service"}]),d=W([{selectedMatchConditionTypes:[],requestMatch:[],selectedRouteDistributeMatchTypes:[],routeDistribute:[{type:"host",condition:"",value:""},{type:"other",list:[{myKey:"",condition:"",value:""}]}]}]);le(d,s=>{m.conditionRule={...m.conditionRule,conditions:te()}},{deep:!0,immediate:!!Q.isNil(m.conditionRule)});const ie=()=>{d.value.push({selectedMatchConditionTypes:[],requestMatch:[],selectedRouteDistributeMatchTypes:[],routeDistribute:[{type:"host",condition:"=",value:"127.0.0.1"},{type:"other",list:[{myKey:"key",condition:"=",value:"value"}]}]})},ue=s=>{d.value.splice(s,1)},ce=s=>{d.value[s].requestMatch=[],d.value[s].selectedMatchConditionTypes=[]},de=s=>{d.value[s].requestMatch=[{type:"host",condition:"",value:""},{type:"application",condition:"",value:""},{type:"method",condition:"",value:""},{type:"arguments",list:[{index:0,condition:"",value:""}]},{type:"attachments",list:[{myKey:"key",condition:"",value:""}]},{type:"other",list:[{myKey:"key",condition:"",value:""}]}]},H=(s,t)=>{d.value[t].selectedMatchConditionTypes=d.value[t].selectedMatchConditionTypes.filter(i=>i!==s)},re=(s,t)=>{d.value[t].selectedRouteDistributeMatchTypes=d.value[t].selectedRouteDistributeMatchTypes.filter(i=>i!==s)},pe=[{dataIndex:"index",key:"index",title:"参数索引"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],ve=(s,t)=>{d.value[s].requestMatch[t].list.push({index:0,condition:"=",value:""})},ye=(s,t,i)=>{d.value[s].requestMatch[t].list.length===1&&(d.value[s].selectedMatchConditionTypes=d.value[s].selectedMatchConditionTypes.filter(h=>h!=="arguments")),d.value[s].requestMatch[t].list.splice(i,1)},he=[{dataIndex:"myKey",key:"myKey",title:"键"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],fe=(s,t)=>{d.value[s].requestMatch[t].list.push({key:"key",condition:"=",value:""})},_e=(s,t,i)=>{d.value[s].requestMatch[t].list.length===1&&(d.value[s].selectedMatchConditionTypes=d.value[s].selectedMatchConditionTypes.filter(h=>h!=="attachments")),d.value[s].requestMatch[t].list.splice(i,1)},I=[{dataIndex:"myKey",key:"myKey",title:"键"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],ke=(s,t)=>{d.value[s].requestMatch[t].list.push({myKey:"",condition:"=",value:""})},be=(s,t,i)=>{if(d.value[s].requestMatch[t].list.length===1){d.value[s].selectedMatchConditionTypes=d.value[s].selectedMatchConditionTypes.filter(h=>h!=="other");return}d.value[s].requestMatch[t].list.splice(i,1)},ge=(s,t)=>{d.value[s].routeDistribute[t].list.push({myKey:"",condition:"=",value:""})},Ce=(s,t,i)=>{if(d.value[s].routeDistribute[t].list.length===1){d.value[s].selectedRouteDistributeMatchTypes=d.value[s].selectedRouteDistributeMatchTypes.filter(h=>h!=="other");return}d.value[s].routeDistribute[t].list.splice(i,1)};function ee(s){var f,q;const t=d.value[s],{ruleGranularity:i,objectOfAction:h}=C;let r=`对于${i==="service"?"服务":"应用"}【${h||"未指定"}】`,n=[];(f=t.selectedMatchConditionTypes)==null||f.forEach(U=>{var V,P,p,b;const R=(V=t.requestMatch)==null?void 0:V.find(a=>a.type===U);if(!R)return;let y="";const S=R.condition==="="?"等于":R.condition==="!="?"不等于":R.condition||"",z=R.value||"未指定";switch(U){case"host":y=`请求来源主机 ${S} ${z}`;break;case"application":y=`请求来源应用 ${S} ${z}`;break;case"method":y=`请求方法 ${S} ${z}`;break;case"arguments":const a=(P=R.list)==null?void 0:P.map(u=>{const B=u.condition==="="?"等于":u.condition==="!="?"不等于":u.condition||"",D=u.value!==void 0&&u.value!==""?u.value:"未指定";return`参数[${u.index}] ${B} ${D}`}).filter(Boolean);(a==null?void 0:a.length)>0&&(y=a.join(" 且 "));break;case"attachments":const T=(p=R.list)==null?void 0:p.map(u=>{const B=u.condition==="="?"等于":u.condition==="!="?"不等于":u.condition||"",D=u.value!==void 0&&u.value!==""?u.value:"未指定";return`附件[${u.myKey||"未指定"}] ${B} ${D}`}).filter(Boolean);(T==null?void 0:T.length)>0&&(y=T.join(" 且 "));break;case"other":const c=(b=R.list)==null?void 0:b.map(u=>{const B=u.condition==="="?"等于":u.condition==="!="?"不等于":u.condition||"",D=u.value!==void 0&&u.value!==""?u.value:"未指定";return`自定义匹配[${u.myKey||"未指定"}] ${B} ${D}`}).filter(Boolean);(c==null?void 0:c.length)>0&&(y=c.join(" 且 "));break}y&&((U==="host"||U==="application"||U==="method")&&!R.value?n.push(`${U==="host"?"请求来源主机":U==="application"?"请求来源应用":"请求方法"} 未填写`):n.push(y))});const k=n.length>0?n.join(" 且 "):"任意请求";let o=[];(q=t.selectedRouteDistributeMatchTypes)==null||q.forEach(U=>{var V,P;const R=(V=t.routeDistribute)==null?void 0:V.find(p=>p.type===U);if(!R)return;let y="";const S=R.condition==="="?"等于":R.condition==="!="?"不等于":R.condition||"",z=R.value||"未指定";switch(U){case"host":y=`目标主机 ${S} ${z}`;break;case"other":const p=(P=R.list)==null?void 0:P.map(b=>{const a=b.condition==="="?"等于":b.condition==="!="?"不等于":b.condition||"",T=b.value!==void 0&&b.value!==""?b.value:"未指定";return`目标标签[${b.myKey||"未指定"}] ${a} ${T}`}).filter(Boolean);(p==null?void 0:p.length)>0&&(y=p.join(" 且 "));break}y&&(U==="host"&&!R.value?o.push("目标主机 未填写"):o.push(y))});const M=o.length>0?`满足 【${o.join(" 且 ")}】`:"默认路由规则";return`${r}，将满足 【${k}】 条件的请求，转发到 ${M} 的实例。`}function te(){let s=[],t="",i="";return d.value.forEach((h,$)=>{h.selectedMatchConditionTypes.forEach((n,k)=>{h.requestMatch.forEach((o,M)=>{if(n==(o==null?void 0:o.type))switch(o==null?void 0:o.type){case"arguments":o.list.forEach((f,q)=>{t.length>0&&(t+=" & "),t+=`${n}[${f.index}]${f.condition}${f.value}`});break;case"attachments":o.list.forEach((f,q)=>{t.length>0&&(t+=" & "),t+=`${n}[${f.myKey}]${f.condition}${f.value}`});break;case"other":o.list.forEach((f,q)=>{t.length>0&&(t+=" & "),t+=`${f.myKey}${f.condition}${f.value}`});break;default:t.length>0&&(t+=" & "),t+=`${o.type}${o.condition}${o.value}`}})}),h.selectedRouteDistributeMatchTypes.forEach((n,k)=>{h.routeDistribute.forEach((o,M)=>{if(n==(o==null?void 0:o.type))switch(o==null?void 0:o.type){case"other":o==null||o.list.forEach((f,q)=>{i.length>0&&(i+=" & "),i+=`${f.myKey}${f.condition}${f.value}`});break;default:i.length>0&&(i+=" & "),i+=`${o.type}${o.condition}${o.value}`}})});let r="";t.length>0&&i.length>0?r=`${t} => ${i}`:t.length>0&&i.length==0&&(r=`${t}`),s.push(r)}),s}const Me=async()=>{const{version:s,ruleGranularity:t,objectOfAction:i,enable:h,faultTolerantProtection:$,runtime:r,group:n}=C,k={configVersion:"v3.0",scope:t,key:i,enabled:h,force:$,runtime:r,conditions:te()};let o="";t=="application"?o=`${i}.condition-router`:o=`${i}:${s}:${n}.condition-router`,(await Be(o,k)).code===200&&ae.push("/traffic/routingRule")};function $e(s,t){const i=[],h=s.split(" & ");return[{type:"host",condition:"",value:""},{type:"application",condition:"",value:""},{type:"method",condition:"",value:""},{type:"arguments",list:[]},{type:"attachments",list:[]},{type:"other",list:[]}].forEach(r=>i.push({...r})),h.forEach(r=>{if(r=r.trim(),r.startsWith("host")){d.value[t].selectedMatchConditionTypes.push("host");const n=r.match(/^host(!=|=)(.+)/);if(n){const k=n[1],o=n[2].trim(),M=i.find(f=>f.type==="host");M.condition=k,M.value=o}}else if(r.startsWith("application")){d.value[t].selectedMatchConditionTypes.push("application");const n=r.match(/^application(!=|=)(.+)/);if(n){const k=n[1],o=n[2].trim(),M=i.find(f=>f.type==="application");M.condition=k,M.value=o}}else if(r.startsWith("method")){d.value[t].selectedMatchConditionTypes.push("method");const n=r.match(/^method(!=|=)(.+)/);if(n){const k=n[1],o=n[2].trim(),M=i.find(f=>f.type==="method");M.condition=k,M.value=o}}else if(r.startsWith("arguments")){!d.value[t].selectedMatchConditionTypes.includes("arguments")&&d.value[t].selectedMatchConditionTypes.push("arguments");const n=r.match(/^arguments\[(\d+)\](!=|=)(.+)/);if(n){const k=parseInt(n[1],10),o=n[2],M=n[3].trim();i.find(q=>q.type==="arguments").list.push({index:k,condition:o,value:M})}}else if(r.startsWith("attachments")){!d.value[t].selectedMatchConditionTypes.includes("attachments")&&d.value[t].selectedMatchConditionTypes.push("attachments");const n=r.match(/^attachments\[(.+)\](!=|=)(.+)/);if(n){const k=n[1].trim(),o=n[2],M=n[3].trim();i.find(q=>q.type==="attachments").list.push({myKey:k,condition:o,value:M})}}else{const n=r.match(/^([^!=]+)(!?=)(.+)$/);if(n){!d.value[t].selectedMatchConditionTypes.includes("other")&&d.value[t].selectedMatchConditionTypes.push("other");const k=i.find(o=>o.type==="other");k&&k.list.push({myKey:n[1].trim(),condition:n[2],value:n[3].trim()})}}}),i}function Te(s,t){const i=[],h=s==null?void 0:s.split(" & ");return[{type:"host",condition:"",value:""},{type:"other",list:[]}].forEach(r=>i.push({...r})),h!=null&&h.length&&h.forEach(r=>{if(r=r.trim(),r.startsWith("host")){d.value[t].selectedRouteDistributeMatchTypes.push("host");const n=r.match(/^host(!=|=)(.+)/);if(n){const k=n[1],o=n[2].trim(),M=i.find(f=>f.type==="host");M.condition=k,M.value=o}}else{const n=r.match(/^([^!=]+)(!?=)(.+)$/);if(n){!d.value[t].selectedRouteDistributeMatchTypes.includes("other")&&d.value[t].selectedRouteDistributeMatchTypes.push("other");const k=i.find(o=>o.type==="other");k&&k.list.push({myKey:n[1].trim(),condition:n[2],value:n[3].trim()})}}}),i}return(s,t)=>{const i=K("a-button"),h=K("a-flex"),$=K("a-select"),r=K("a-form-item"),n=K("a-input"),k=K("a-switch"),o=K("a-col"),M=K("a-input-number"),f=K("a-row"),q=K("a-form"),U=K("a-card"),R=K("a-tooltip"),y=K("a-space"),S=K("a-tag"),z=K("a-table"),V=K("a-descriptions-item"),P=K("a-descriptions");return v(),F("div",Ge,[e(h,{style:{width:"100%"}},{default:l(()=>[e(o,{span:x.value?24-Z.value:24,class:"left"},{default:l(()=>[e(U,null,{default:l(()=>[e(y,{style:{width:"100%"},direction:"vertical",size:"middle"},{default:l(()=>[e(f,null,{default:l(()=>[e(h,{justify:"end",style:{width:"100%"}},{default:l(()=>[e(i,{type:"text",style:{color:"#0a90d5"},onClick:t[0]||(t[0]=p=>x.value=!x.value)},{default:l(()=>[g(" 字段说明 "),x.value?(v(),_(j(Ee),{key:1})):(v(),_(j(je),{key:0}))]),_:1})]),_:1}),e(U,{title:"基础信息",style:{width:"100%"},class:"_detail"},{default:l(()=>[e(q,{layout:"horizontal"},{default:l(()=>[e(f,{style:{width:"100%"}},{default:l(()=>[e(o,{span:12},{default:l(()=>[e(r,{label:"规则粒度",required:""},{default:l(()=>[e($,{value:C.ruleGranularity,"onUpdate:value":t[1]||(t[1]=p=>C.ruleGranularity=p),style:{width:"120px"},options:oe.value},null,8,["value","options"])]),_:1}),C.ruleGranularity==="service"?(v(),_(r,{key:0,label:"版本",required:""},{default:l(()=>[e(n,{value:C.version,"onUpdate:value":t[2]||(t[2]=p=>C.version=p),style:{width:"300px"}},null,8,["value"])]),_:1})):O("",!0),e(r,{label:"容错保护"},{default:l(()=>[e(k,{checked:C.faultTolerantProtection,"onUpdate:checked":t[3]||(t[3]=p=>C.faultTolerantProtection=p),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1}),e(r,{label:"运行时生效"},{default:l(()=>[e(k,{checked:C.runtime,"onUpdate:checked":t[4]||(t[4]=p=>C.runtime=p),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})]),_:1}),e(o,{span:12},{default:l(()=>[e(r,{label:"作用对象",required:""},{default:l(()=>[e(n,{value:C.objectOfAction,"onUpdate:value":t[5]||(t[5]=p=>C.objectOfAction=p),style:{width:"300px"}},null,8,["value"])]),_:1}),C.ruleGranularity==="service"?(v(),_(r,{key:0,label:"分组",required:""},{default:l(()=>[e(n,{value:C.group,"onUpdate:value":t[6]||(t[6]=p=>C.group=p),style:{width:"300px"}},null,8,["value"])]),_:1})):O("",!0),e(r,{label:"立即启用"},{default:l(()=>[e(k,{checked:C.enable,"onUpdate:checked":t[7]||(t[7]=p=>C.enable=p),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1}),e(r,{label:"优先级"},{default:l(()=>[e(M,{value:C.priority,"onUpdate:value":t[8]||(t[8]=p=>C.priority=p),min:"1"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(U,{title:"路由列表",style:{width:"100%"},class:"_detail"},{default:l(()=>[(v(!0),F(L,null,X(d.value,(p,b)=>(v(),_(U,null,{title:l(()=>[e(h,{justify:"space-between"},{default:l(()=>[e(y,{align:"center"},{default:l(()=>[G("div",null,"路由【"+E(b+1)+"】",1),e(R,null,{title:l(()=>[g(E(ee(b)),1)]),default:l(()=>[G("div",me,E(ee(b)),1)]),_:2},1024)]),_:2},1024),e(j(A),{onClick:a=>ue(b),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)]),default:l(()=>[e(q,{layout:"horizontal"},{default:l(()=>[e(y,{style:{width:"100%"},direction:"vertical",size:"large"},{default:l(()=>[e(r,{label:"请求匹配"},{default:l(()=>[p.requestMatch.length>0?(v(),_(U,{key:0},{default:l(()=>[e(y,{style:{width:"100%"},direction:"vertical",size:"small"},{default:l(()=>[e(h,{align:"center",justify:"space-between"},{default:l(()=>[e(r,{label:"匹配条件类型"},{default:l(()=>[e($,{value:p.selectedMatchConditionTypes,"onUpdate:value":a=>p.selectedMatchConditionTypes=a,options:ne.value,mode:"multiple",style:{"min-width":"200px"}},null,8,["value","onUpdate:value","options"])]),_:2},1024),e(j(A),{onClick:a=>ce(b),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024),(v(!0),F(L,null,X(p.requestMatch,(a,T)=>(v(),F(L,null,[p.selectedMatchConditionTypes.includes("host")&&a.type==="host"?(v(),_(y,{key:0,size:"large",align:"center"},{default:l(()=>[e(S,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[g(E(a==null?void 0:a.type),1)]),_:2},1024),e($,{value:a.condition,"onUpdate:value":c=>a.condition=c,style:{"min-width":"120px"},options:N.value},null,8,["value","onUpdate:value","options"]),e(n,{value:a.value,"onUpdate:value":c=>a.value=c,placeholder:"请求来源ip"},null,8,["value","onUpdate:value"]),e(j(A),{onClick:c=>H(a==null?void 0:a.type,b),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):O("",!0),p.selectedMatchConditionTypes.includes("application")&&a.type==="application"?(v(),_(y,{key:1,size:"large",align:"center"},{default:l(()=>[e(S,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[g(E(a==null?void 0:a.type),1)]),_:2},1024),e($,{value:a.condition,"onUpdate:value":c=>a.condition=c,style:{"min-width":"120px"},options:N.value},null,8,["value","onUpdate:value","options"]),e(n,{value:a.value,"onUpdate:value":c=>a.value=c,placeholder:"请求来源应用名"},null,8,["value","onUpdate:value"]),e(j(A),{onClick:c=>H(a==null?void 0:a.type,b),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):O("",!0),p.selectedMatchConditionTypes.includes("method")&&a.type==="method"?(v(),_(y,{key:2,size:"large",align:"center"},{default:l(()=>[e(S,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[g(E(a==null?void 0:a.type),1)]),_:2},1024),e($,{value:a.condition,"onUpdate:value":c=>a.condition=c,style:{"min-width":"120px"},options:N.value},null,8,["value","onUpdate:value","options"]),e(n,{value:a.value,"onUpdate:value":c=>a.value=c,placeholder:"方法值"},null,8,["value","onUpdate:value"]),e(j(A),{onClick:c=>H(a==null?void 0:a.type,b),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):O("",!0),p.selectedMatchConditionTypes.includes("arguments")&&a.type==="arguments"?(v(),_(y,{key:3,style:{width:"100%"},size:"large",align:"start"},{default:l(()=>[e(S,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[g(E(a==null?void 0:a.type),1)]),_:2},1024),e(y,{direction:"vertical"},{default:l(()=>[e(i,{type:"primary",onClick:c=>ve(b,T)},{default:l(()=>[g(" 添加argument ")]),_:2},1032,["onClick"]),e(z,{pagination:!1,columns:pe,"data-source":p.requestMatch[T].list},{bodyCell:l(({column:c,record:u,text:B,index:D})=>[c.key==="index"?(v(),_(n,{key:0,value:u.index,"onUpdate:value":w=>u.index=w,placeholder:"index"},null,8,["value","onUpdate:value"])):c.key==="condition"?(v(),_($,{key:1,value:u.condition,"onUpdate:value":w=>u.condition=w,options:N.value},null,8,["value","onUpdate:value","options"])):c.key==="value"?(v(),_(n,{key:2,value:u.value,"onUpdate:value":w=>u.value=w,placeholder:"value"},null,8,["value","onUpdate:value"])):c.key==="operation"?(v(),_(y,{key:3,align:"center"},{default:l(()=>[e(j(A),{onClick:w=>ye(b,T,D),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):O("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):O("",!0),p.selectedMatchConditionTypes.includes("attachments")&&a.type==="attachments"?(v(),_(y,{key:4,style:{width:"100%"},size:"large",align:"start"},{default:l(()=>[e(S,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[g(E(a==null?void 0:a.type),1)]),_:2},1024),e(y,{direction:"vertical"},{default:l(()=>[e(i,{type:"primary",onClick:c=>fe(b,T)},{default:l(()=>[g(" 添加attachment ")]),_:2},1032,["onClick"]),e(z,{pagination:!1,columns:he,"data-source":p.requestMatch[T].list},{bodyCell:l(({column:c,record:u,text:B,index:D})=>[c.key==="myKey"?(v(),_(n,{key:0,value:u.myKey,"onUpdate:value":w=>u.myKey=w,placeholder:"key"},null,8,["value","onUpdate:value"])):c.key==="condition"?(v(),_($,{key:1,value:u.condition,"onUpdate:value":w=>u.condition=w,options:N.value},null,8,["value","onUpdate:value","options"])):c.key==="value"?(v(),_(n,{key:2,value:u.value,"onUpdate:value":w=>u.value=w,placeholder:"value"},null,8,["value","onUpdate:value"])):c.key==="operation"?(v(),_(y,{key:3,align:"center"},{default:l(()=>[e(j(A),{onClick:w=>_e(b,T,D),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):O("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):O("",!0),p.selectedMatchConditionTypes.includes("other")&&a.type==="other"?(v(),_(y,{key:5,style:{width:"100%"},size:"large",align:"start"},{default:l(()=>[e(S,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[g(E((a==null?void 0:a.type)=="other"?"其他":a==null?void 0:a.type),1)]),_:2},1024),e(y,{direction:"vertical"},{default:l(()=>[e(i,{type:"primary",onClick:c=>ke(b,T)},{default:l(()=>[g(" 添加other ")]),_:2},1032,["onClick"]),e(z,{pagination:!1,columns:I,"data-source":p.requestMatch[T].list},{bodyCell:l(({column:c,record:u,text:B})=>[c.key==="myKey"?(v(),_(n,{key:0,value:u.myKey,"onUpdate:value":D=>u.myKey=D,placeholder:"key"},null,8,["value","onUpdate:value"])):c.key==="condition"?(v(),_($,{key:1,value:u.condition,"onUpdate:value":D=>u.condition=D,options:N.value},null,8,["value","onUpdate:value","options"])):c.key==="value"?(v(),_(n,{key:2,value:u.value,"onUpdate:value":D=>u.value=D,placeholder:"value"},null,8,["value","onUpdate:value"])):c.key==="operation"?(v(),_(y,{key:3,align:"center"},{default:l(()=>[e(j(A),{onClick:D=>be(b,T,u.index),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):O("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):O("",!0)],64))),256))]),_:2},1024)]),_:2},1024)):(v(),_(i,{key:1,onClick:a=>de(b),type:"dashed",size:"large"},{icon:l(()=>[e(j(A),{icon:"tdesign:add"})]),default:l(()=>[g(" 增加匹配条件 ")]),_:2},1032,["onClick"]))]),_:2},1024),e(r,{label:"路由分发",required:""},{default:l(()=>[e(U,null,{default:l(()=>[e(y,{style:{width:"100%"},direction:"vertical",size:"small"},{default:l(()=>[e(h,null,{default:l(()=>[e(r,{label:"匹配条件类型"},{default:l(()=>[e($,{value:p.selectedRouteDistributeMatchTypes,"onUpdate:value":a=>p.selectedRouteDistributeMatchTypes=a,options:se.value,mode:"multiple",style:{"min-width":"200px"}},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1024),(v(!0),F(L,null,X(p.routeDistribute,(a,T)=>(v(),F(L,{key:T},[p.selectedRouteDistributeMatchTypes.includes("host")&&a.type==="host"?(v(),_(y,{key:0,size:"large",align:"center"},{default:l(()=>[e(S,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[g(E(a==null?void 0:a.type),1)]),_:2},1024),e($,{value:a.condition,"onUpdate:value":c=>a.condition=c,style:{"min-width":"120px"},options:N.value},null,8,["value","onUpdate:value","options"]),e(n,{value:a.value,"onUpdate:value":c=>a.value=c,placeholder:"请求来源ip"},null,8,["value","onUpdate:value"]),e(j(A),{onClick:c=>re(a==null?void 0:a.type,b),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):O("",!0),p.selectedRouteDistributeMatchTypes.includes("other")&&a.type==="other"?(v(),_(y,{key:1,style:{width:"100%"},size:"large",align:"start"},{default:l(()=>[e(S,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:l(()=>[g(E((a==null?void 0:a.type)=="other"?"其他":a==null?void 0:a.type),1)]),_:2},1024),e(y,{direction:"vertical"},{default:l(()=>[e(i,{type:"primary",onClick:c=>ge(b,T)},{default:l(()=>[g(" 添加其他 ")]),_:2},1032,["onClick"]),e(z,{pagination:!1,columns:I,"data-source":p.routeDistribute[T].list},{bodyCell:l(({column:c,record:u,text:B,index:D})=>[c.key==="myKey"?(v(),_(n,{key:0,value:u.myKey,"onUpdate:value":w=>u.myKey=w,placeholder:"key"},null,8,["value","onUpdate:value"])):c.key==="condition"?(v(),_($,{key:1,value:u.condition,"onUpdate:value":w=>u.condition=w,options:N.value},null,8,["value","onUpdate:value","options"])):c.key==="value"?(v(),_(n,{key:2,value:u.value,"onUpdate:value":w=>u.value=w,placeholder:"value"},null,8,["value","onUpdate:value"])):c.key==="operation"?(v(),_(y,{key:3,align:"center"},{default:l(()=>[e(j(A),{onClick:w=>Ce(b,T,D),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):O("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):O("",!0)],64))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(i,{onClick:ie,type:"primary"},{default:l(()=>[g(" 增加路由")]),_:1})]),_:1})]),_:1})]),_:1},8,["span"]),e(o,{span:x.value?Z.value:0,class:"right"},{default:l(()=>[x.value?(v(),_(U,{key:0,class:"sliderBox"},{default:l(()=>[G("div",null,[e(P,{title:"字段说明",column:1},{default:l(()=>[e(V,{label:"key"},{default:l(()=>[g(" 作用对象"),Ne,g(" 可能的值：Dubbo应用名或者服务名 ")]),_:1}),e(V,{label:"scope"},{default:l(()=>[g(" 规则粒度"),Pe,g(" 可能的值：application, service ")]),_:1}),e(V,{label:"force"},{default:l(()=>[g(" 容错保护"),We,g(" 可能的值：true, false"),xe,g(" 描述：如果为true，则路由筛选后若没有可用的地址则会直接报异常；如果为false，则会从可用地址中选择完成RPC调用 ")]),_:1}),e(V,{label:"runtime"},{default:l(()=>[g(" 运行时生效"),Fe,g(" 可能的值：true, false"),Je,g(" 描述：如果为true，则该rule下的所有路由将会实时生效；若为false，则只有在启动时才会生效 ")]),_:1})]),_:1})])]),_:1})):O("",!0)]),_:1},8,["span"])]),_:1}),e(U,{class:"footer"},{default:l(()=>[e(h,null,{default:l(()=>[e(i,{type:"primary",onClick:Me},{default:l(()=>[g("确认")]),_:1})]),_:1})]),_:1})])}}}),Ze=Ve(Le,[["__scopeId","data-v-86523a1c"]]);export{Ze as default};
