import{u as Ue}from"./index-37m6CaHp.js";import{d as $e,g as we,u as De,n as B,r as Re,Q as Oe,f as W,c as e,t,e as w,o as r,z as b,v as h,h as O,a9 as qe,aa as Ke,K as D,F,y as Q,J as E,B as z,I as j,G as je,H as Ae,_ as ze}from"./index-WfxyH1kR.js";import{g as Ee,u as Ve}from"./traffic-jiWu3d0C.js";import"./request-2cLtQ4vm.js";const N=V=>(je("data-v-f9c27678"),V=V(),Ae(),V),Ge={class:"__container_routingRule_detail"},Se=N(()=>E("br",null,null,-1)),Be=N(()=>E("br",null,null,-1)),Pe=N(()=>E("br",null,null,-1)),We=N(()=>E("br",null,null,-1)),Ne=N(()=>E("br",null,null,-1)),Fe=N(()=>E("br",null,null,-1));var m=(V=>(V.application="应用",V.service="服务",V))(m||{});const Le=$e({__name:"updateByFormView",setup(V){we();const x=De(),P=B(!1),X=B(8);Ue().toClipboard;const f=Re({configVersion:"",ruleGranularity:"",objectOfAction:"",enable:!1,faultTolerantProtection:!1,runtime:!1,priority:null,group:""}),I=B([{label:"host",value:"host"},{label:"application",value:"application"},{label:"method",value:"method"},{label:"arguments",value:"arguments"},{label:"attachments",value:"attachments"},{label:"其他",value:"other"}]),ee=B([{label:"host",value:"host"},{label:"其他",value:"other"}]),G=B([{label:"=",value:"="},{label:"!=",value:"!="}]),le=B([{label:"应用",value:"application"},{label:"服务",value:"service"}]),i=B([{selectedMatchConditionTypes:[],requestMatch:[],selectedRouteDistributeMatchTypes:[],routeDistribute:[{type:"host",condition:"=",value:"127.0.0.1"},{type:"other",list:[{myKey:"key",condition:"=",value:"value"}]}]}]),te=()=>{i.value.push({selectedMatchConditionTypes:[],requestMatch:[],selectedRouteDistributeMatchTypes:[],routeDistribute:[{type:"host",condition:"=",value:"127.0.0.1"},{type:"other",list:[{myKey:"key",condition:"=",value:"value"}]}]})},ae=n=>{i.value.splice(n,1)},se=n=>{i.value[n].requestMatch=[],i.value[n].selectedMatchConditionTypes=[]},ne=n=>{i.value[n].requestMatch=[{type:"host",condition:"",value:""},{type:"application",condition:"",value:""},{type:"method",condition:"",value:""},{type:"arguments",list:[{index:0,condition:"",value:""}]},{type:"attachments",list:[{myKey:"key",condition:"",value:""}]},{type:"other",list:[{myKey:"key",condition:"",value:""}]}]},H=(n,l)=>{i.value[l].selectedMatchConditionTypes=i.value[l].selectedMatchConditionTypes.filter(o=>o!==n)},oe=(n,l)=>{i.value[l].selectedRouteDistributeMatchTypes=i.value[l].selectedRouteDistributeMatchTypes.filter(o=>o!==n)},ue=[{dataIndex:"index",key:"index",title:"参数索引"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],ie=(n,l)=>{i.value[n].requestMatch[l].list.push({index:0,condition:"=",value:""})},ce=(n,l,o)=>{i.value[n].requestMatch[l].list.length===1&&(i.value[n].selectedMatchConditionTypes=i.value[n].selectedMatchConditionTypes.filter(v=>v!=="arguments")),i.value[n].requestMatch[l].list.splice(o,1)},de=[{dataIndex:"myKey",key:"myKey",title:"键"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],re=(n,l)=>{i.value[n].requestMatch[l].list.push({key:"key",condition:"=",value:""})},pe=(n,l,o)=>{i.value[n].requestMatch[l].list.length===1&&(i.value[n].selectedMatchConditionTypes=i.value[n].selectedMatchConditionTypes.filter(v=>v!=="attachments")),i.value[n].requestMatch[l].list.splice(o,1)},Y=[{dataIndex:"myKey",key:"myKey",title:"键"},{dataIndex:"condition",key:"condition",title:"关系"},{dataIndex:"value",key:"value",title:"值"},{dataIndex:"operation",key:"operation",title:"操作"}],ye=(n,l)=>{i.value[n].requestMatch[l].list.push({myKey:"",condition:"=",value:""})},ve=(n,l,o)=>{if(i.value[n].requestMatch[l].list.length===1){i.value[n].selectedMatchConditionTypes=i.value[n].selectedMatchConditionTypes.filter(v=>v!=="other");return}i.value[n].requestMatch[l].list.splice(o,1)},he=(n,l)=>{i.value[n].routeDistribute[l].list.push({myKey:"",condition:"=",value:""})},fe=(n,l,o)=>{if(i.value[n].routeDistribute[l].list.length===1){i.value[n].selectedRouteDistributeMatchTypes=i.value[n].selectedRouteDistributeMatchTypes.filter(v=>v!=="other");return}i.value[n].routeDistribute[l].list.splice(o,1)},_e=n=>{let l=m[f.ruleGranularity]+f.objectOfAction,o="",v="";return i.value[n].requestMatch.forEach((C,c)=>{if(i.value[n].selectedMatchConditionTypes.includes(C.type))if(C.type==="arguments"){C.list.forEach((s,k)=>{const{index:u,condition:_,value:p}=s;let U=`${u}${_}${p}`;o+=U+","});return}else{const{type:s,condition:k,value:u}=C;let _=s+k+u;o+=_+" , "}}),`对于${l},将满足=>${o}的请求，转发到=>${v}的实例`};function ke(n,l){const o=[],v=n.split(" & ");return[{type:"host",condition:"",value:""},{type:"application",condition:"",value:""},{type:"method",condition:"",value:""},{type:"arguments",list:[]},{type:"attachments",list:[]},{type:"other",list:[]}].forEach(c=>o.push({...c})),v.forEach(c=>{if(c=c.trim(),c.startsWith("host")){i.value[l].selectedMatchConditionTypes.push("host");const s=c.match(/^host(!=|=)(.+)/);if(s){const k=s[1],u=s[2].trim(),_=o.find(p=>p.type==="host");_.condition=k,_.value=u}}else if(c.startsWith("application")){i.value[l].selectedMatchConditionTypes.push("application");const s=c.match(/^application(!=|=)(.+)/);if(s){const k=s[1],u=s[2].trim(),_=o.find(p=>p.type==="application");_.condition=k,_.value=u}}else if(c.startsWith("method")){i.value[l].selectedMatchConditionTypes.push("method");const s=c.match(/^method(!=|=)(.+)/);if(s){const k=s[1],u=s[2].trim(),_=o.find(p=>p.type==="method");_.condition=k,_.value=u}}else if(c.startsWith("arguments")){!i.value[l].selectedMatchConditionTypes.includes("arguments")&&i.value[l].selectedMatchConditionTypes.push("arguments");const s=c.match(/^arguments\[(\d+)\](!=|=)(.+)/);if(s){const k=parseInt(s[1],10),u=s[2],_=s[3].trim();o.find(U=>U.type==="arguments").list.push({index:k,condition:u,value:_})}}else if(c.startsWith("attachments")){!i.value[l].selectedMatchConditionTypes.includes("attachments")&&i.value[l].selectedMatchConditionTypes.push("attachments");const s=c.match(/^attachments\[(.+)\](!=|=)(.+)/);if(s){const k=s[1].trim(),u=s[2],_=s[3].trim();o.find(U=>U.type==="attachments").list.push({myKey:k,condition:u,value:_})}}else if(c.startsWith("other")){!i.value[l].selectedMatchConditionTypes.includes("other")&&i.value[l].selectedMatchConditionTypes.push("other");const s=c.match(/^other\[(.+)\](!=|=)(.+)/);if(s){const k=s[1].trim(),u=s[2],_=s[3].trim();o.find(U=>U.type==="other").list.push({myKey:k,condition:u,value:_})}}}),o}function ge(n,l){const o=[],v=n==null?void 0:n.split(" & ");return[{type:"host",condition:"",value:""},{type:"other",list:[]}].forEach(c=>o.push({...c})),v!=null&&v.length&&v.forEach(c=>{if(c=c.trim(),c.startsWith("host")){i.value[l].selectedRouteDistributeMatchTypes.push("host");const s=c.match(/^host(!=|=)(.+)/);if(s){const k=s[1],u=s[2].trim(),_=o.find(p=>p.type==="host");_.condition=k,_.value=u}}else if(c.startsWith("other")){!i.value[l].selectedRouteDistributeMatchTypes.includes("other")&&i.value[l].selectedRouteDistributeMatchTypes.push("other");const s=c.match(/^other\[(.+)\](!=|=)(.+)/);if(s){const k=s[1].trim(),u=s[2],_=s[3].trim();o.find(U=>U.type==="other").list.push({myKey:k,condition:u,value:_})}}}),o}async function Z(){var l;let n=await Ee((l=x.params)==null?void 0:l.ruleName);if((n==null?void 0:n.code)===200){console.log("res",n.data);const{conditions:o,configVersion:v,enabled:C,force:c,key:s,runtime:k,scope:u}=n==null?void 0:n.data;f.ruleGranularity=u,f.objectOfAction=s,f.enable=C,f.faultTolerantProtection=c,f.runtime=k,f.configVersion=v,v=="v3.0"&&o.forEach((_,p)=>{var K,S;const U=_.split("=>"),A=(K=U[0])==null?void 0:K.trim(),M=(S=U[1])==null?void 0:S.trim();i.value[p].requestMatch=ke(A,p),i.value[p].routeDistribute=ge(M,p)})}}function be(){let n=[],l="",o="";return i.value.forEach((v,C)=>{v.selectedMatchConditionTypes.forEach((s,k)=>{v.requestMatch.forEach((u,_)=>{if(s==(u==null?void 0:u.type))switch(u==null?void 0:u.type){case"arguments":u.list.forEach((p,U)=>{l.length>0&&(l+=" & "),l+=`${s}[${p.index}]${p.condition}${p.value}`});break;case"attachments":u.list.forEach((p,U)=>{l.length>0&&(l+=" & "),l+=`${s}[${p.myKey}]${p.condition}${p.value}`});break;case"other":u.list.forEach((p,U)=>{l.length>0&&(l+=" & "),l+=`${s}[${p.myKey}]${p.condition}${p.value}`});break;default:l.length>0&&(l+=" & "),l+=`${u.type}${u.condition}${u.value}`}})}),v.selectedRouteDistributeMatchTypes.forEach((s,k)=>{v.routeDistribute.forEach((u,_)=>{if(s==(u==null?void 0:u.type))switch(u==null?void 0:u.type){case"other":u==null||u.list.forEach((p,U)=>{o.length>0&&(o+=" & "),o+=`${s}[${p.myKey}]${p.condition}${p.value}`});break;default:o.length>0&&(o+=" & "),o+=`${u.type}${u.condition}${u.value}`}})});let c="";l.length>0&&o.length>0?c=`${l} => ${o}`:l.length>0&&o.length==0&&(c=`${l}`),n.push(c)}),n}const Ce=async()=>{const{ruleName:n}=x.params,{configVersion:l,ruleGranularity:o,objectOfAction:v,enable:C,faultTolerantProtection:c,runtime:s}=f,k={configVersion:l,scope:o,key:v,enabled:C,force:c,runtime:s,conditions:be()},u=await Ve(n,k);(u==null?void 0:u.code)===200&&await Z()},Me=()=>{var l;const n=(l=x.params)==null?void 0:l.ruleName;if(console.log("lll",f),n&&f.ruleGranularity==="service"){const o=n==null?void 0:n.split(":");f.configVersion=o[1],f.group=o[2].split(".")[0]}};return Oe(async()=>{await Z(),Me()}),(n,l)=>{const o=w("a-button"),v=w("a-flex"),C=w("a-select"),c=w("a-form-item"),s=w("a-input"),k=w("a-switch"),u=w("a-col"),_=w("a-input-number"),p=w("a-row"),U=w("a-form"),A=w("a-card"),M=w("a-space"),K=w("a-tag"),S=w("a-table"),L=w("a-descriptions-item"),Te=w("a-descriptions");return r(),W("div",Ge,[e(v,{style:{width:"100%"}},{default:t(()=>[e(u,{span:P.value?24-X.value:24,class:"left"},{default:t(()=>[e(A,null,{default:t(()=>[e(M,{style:{width:"100%"},direction:"vertical",size:"middle"},{default:t(()=>[e(p,null,{default:t(()=>[e(v,{justify:"end",style:{width:"100%"}},{default:t(()=>[e(o,{type:"text",style:{color:"#0a90d5"},onClick:l[0]||(l[0]=y=>P.value=!P.value)},{default:t(()=>[b(" 字段说明 "),P.value?(r(),h(O(Ke),{key:1})):(r(),h(O(qe),{key:0}))]),_:1})]),_:1}),e(A,{title:"基础信息",style:{width:"100%"},class:"_detail"},{default:t(()=>[e(U,{layout:"horizontal"},{default:t(()=>[e(p,{style:{width:"100%"}},{default:t(()=>[e(u,{span:12},{default:t(()=>[e(c,{label:"规则粒度",required:""},{default:t(()=>[e(C,{disabled:"",value:f.ruleGranularity,"onUpdate:value":l[1]||(l[1]=y=>f.ruleGranularity=y),style:{width:"120px"},options:le.value},null,8,["value","options"])]),_:1}),f.ruleGranularity==="service"?(r(),h(c,{key:0,label:"版本",required:""},{default:t(()=>[e(s,{value:f.configVersion,"onUpdate:value":l[2]||(l[2]=y=>f.configVersion=y),style:{width:"300px"},disabled:""},null,8,["value"])]),_:1})):D("",!0),e(c,{label:"容错保护"},{default:t(()=>[e(k,{checked:f.faultTolerantProtection,"onUpdate:checked":l[3]||(l[3]=y=>f.faultTolerantProtection=y),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1}),e(c,{label:"运行时生效"},{default:t(()=>[e(k,{checked:f.runtime,"onUpdate:checked":l[4]||(l[4]=y=>f.runtime=y),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1})]),_:1}),e(u,{span:12},{default:t(()=>[e(c,{label:"作用对象",required:""},{default:t(()=>[e(s,{disabled:"",value:f.objectOfAction,"onUpdate:value":l[5]||(l[5]=y=>f.objectOfAction=y),style:{width:"300px"}},null,8,["value"])]),_:1}),f.ruleGranularity==="service"?(r(),h(c,{key:0,label:"分组",required:""},{default:t(()=>[e(s,{value:f.group,"onUpdate:value":l[6]||(l[6]=y=>f.group=y),style:{width:"300px"},disabled:""},null,8,["value"])]),_:1})):D("",!0),e(c,{label:"立即启用"},{default:t(()=>[e(k,{checked:f.enable,"onUpdate:checked":l[7]||(l[7]=y=>f.enable=y),"checked-children":"开","un-checked-children":"关"},null,8,["checked"])]),_:1}),e(c,{label:"优先级"},{default:t(()=>[e(_,{value:f.priority,"onUpdate:value":l[8]||(l[8]=y=>f.priority=y),min:"1"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(A,{title:"路由列表",style:{width:"100%"},class:"_detail"},{default:t(()=>[(r(!0),W(F,null,Q(i.value,(y,$)=>(r(),h(A,null,{title:t(()=>[e(v,{justify:"space-between"},{default:t(()=>[e(M,{align:"center"},{default:t(()=>[E("div",null,"路由【"+z($+1)+"】",1),E("div",null,z(_e($)),1)]),_:2},1024),e(O(j),{onClick:a=>ae($),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)]),default:t(()=>[e(U,{layout:"horizontal"},{default:t(()=>[e(M,{style:{width:"100%"},direction:"vertical",size:"large"},{default:t(()=>[e(c,{label:"请求匹配"},{default:t(()=>[y.requestMatch.length>0?(r(),h(A,{key:0},{default:t(()=>[e(M,{style:{width:"100%"},direction:"vertical",size:"small"},{default:t(()=>[e(v,{align:"center",justify:"space-between"},{default:t(()=>[e(c,{label:"匹配条件类型"},{default:t(()=>[e(C,{value:y.selectedMatchConditionTypes,"onUpdate:value":a=>y.selectedMatchConditionTypes=a,options:I.value,mode:"multiple",style:{"min-width":"200px"}},null,8,["value","onUpdate:value","options"])]),_:2},1024),e(O(j),{onClick:a=>se($),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024),(r(!0),W(F,null,Q(y.requestMatch,(a,R)=>(r(),W(F,null,[y.selectedMatchConditionTypes.includes("host")&&a.type==="host"?(r(),h(M,{key:0,size:"large",align:"center"},{default:t(()=>[e(K,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:t(()=>[b(z(a==null?void 0:a.type),1)]),_:2},1024),e(C,{value:a.condition,"onUpdate:value":d=>a.condition=d,style:{"min-width":"120px"},options:G.value},null,8,["value","onUpdate:value","options"]),e(s,{value:a.value,"onUpdate:value":d=>a.value=d,placeholder:"请求来源ip"},null,8,["value","onUpdate:value"]),e(O(j),{onClick:d=>H(a==null?void 0:a.type,$),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):D("",!0),y.selectedMatchConditionTypes.includes("application")&&a.type==="application"?(r(),h(M,{key:1,size:"large",align:"center"},{default:t(()=>[e(K,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:t(()=>[b(z(a==null?void 0:a.type),1)]),_:2},1024),e(C,{value:a.condition,"onUpdate:value":d=>a.condition=d,style:{"min-width":"120px"},options:G.value},null,8,["value","onUpdate:value","options"]),e(s,{value:a.value,"onUpdate:value":d=>a.value=d,placeholder:"请求来源应用名"},null,8,["value","onUpdate:value"]),e(O(j),{onClick:d=>H(a==null?void 0:a.type,$),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):D("",!0),y.selectedMatchConditionTypes.includes("method")&&a.type==="method"?(r(),h(M,{key:2,size:"large",align:"center"},{default:t(()=>[e(K,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:t(()=>[b(z(a==null?void 0:a.type),1)]),_:2},1024),e(C,{value:a.condition,"onUpdate:value":d=>a.condition=d,style:{"min-width":"120px"},options:G.value},null,8,["value","onUpdate:value","options"]),e(s,{value:a.value,"onUpdate:value":d=>a.value=d,placeholder:"方法值"},null,8,["value","onUpdate:value"]),e(O(j),{onClick:d=>H(a==null?void 0:a.type,$),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):D("",!0),y.selectedMatchConditionTypes.includes("arguments")&&a.type==="arguments"?(r(),h(M,{key:3,style:{width:"100%"},size:"large",align:"start"},{default:t(()=>[e(K,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:t(()=>[b(z(a==null?void 0:a.type),1)]),_:2},1024),e(M,{direction:"vertical"},{default:t(()=>[e(o,{type:"primary",onClick:d=>ie($,R)},{default:t(()=>[b(" 添加argument ")]),_:2},1032,["onClick"]),e(S,{pagination:!1,columns:ue,"data-source":y.requestMatch[R].list},{bodyCell:t(({column:d,record:g,text:J,index:q})=>[d.key==="index"?(r(),h(s,{key:0,value:g.index,"onUpdate:value":T=>g.index=T,placeholder:"index"},null,8,["value","onUpdate:value"])):d.key==="condition"?(r(),h(C,{key:1,value:g.condition,"onUpdate:value":T=>g.condition=T,options:G.value},null,8,["value","onUpdate:value","options"])):d.key==="value"?(r(),h(s,{key:2,value:g.value,"onUpdate:value":T=>g.value=T,placeholder:"value"},null,8,["value","onUpdate:value"])):d.key==="operation"?(r(),h(M,{key:3,align:"center"},{default:t(()=>[e(O(j),{onClick:T=>ce($,R,q),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):D("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):D("",!0),y.selectedMatchConditionTypes.includes("attachments")&&a.type==="attachments"?(r(),h(M,{key:4,style:{width:"100%"},size:"large",align:"start"},{default:t(()=>[e(K,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:t(()=>[b(z(a==null?void 0:a.type),1)]),_:2},1024),e(M,{direction:"vertical"},{default:t(()=>[e(o,{type:"primary",onClick:d=>re($,R)},{default:t(()=>[b(" 添加attachment ")]),_:2},1032,["onClick"]),e(S,{pagination:!1,columns:de,"data-source":y.requestMatch[R].list},{bodyCell:t(({column:d,record:g,text:J,index:q})=>[d.key==="myKey"?(r(),h(s,{key:0,value:g.myKey,"onUpdate:value":T=>g.myKey=T,placeholder:"key"},null,8,["value","onUpdate:value"])):d.key==="condition"?(r(),h(C,{key:1,value:g.condition,"onUpdate:value":T=>g.condition=T,options:G.value},null,8,["value","onUpdate:value","options"])):d.key==="value"?(r(),h(s,{key:2,value:g.value,"onUpdate:value":T=>g.value=T,placeholder:"value"},null,8,["value","onUpdate:value"])):d.key==="operation"?(r(),h(M,{key:3,align:"center"},{default:t(()=>[e(O(j),{onClick:T=>pe($,R,q),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):D("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):D("",!0),y.selectedMatchConditionTypes.includes("other")&&a.type==="other"?(r(),h(M,{key:5,style:{width:"100%"},size:"large",align:"start"},{default:t(()=>[e(K,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:t(()=>[b(z((a==null?void 0:a.type)=="other"?"其他":a==null?void 0:a.type),1)]),_:2},1024),e(M,{direction:"vertical"},{default:t(()=>[e(o,{type:"primary",onClick:d=>ye($,R)},{default:t(()=>[b(" 添加other ")]),_:2},1032,["onClick"]),e(S,{pagination:!1,columns:Y,"data-source":y.requestMatch[R].list},{bodyCell:t(({column:d,record:g,text:J})=>[d.key==="myKey"?(r(),h(s,{key:0,value:g.myKey,"onUpdate:value":q=>g.myKey=q,placeholder:"key"},null,8,["value","onUpdate:value"])):d.key==="condition"?(r(),h(C,{key:1,value:g.condition,"onUpdate:value":q=>g.condition=q,options:G.value},null,8,["value","onUpdate:value","options"])):d.key==="value"?(r(),h(s,{key:2,value:g.value,"onUpdate:value":q=>g.value=q,placeholder:"value"},null,8,["value","onUpdate:value"])):d.key==="operation"?(r(),h(M,{key:3,align:"center"},{default:t(()=>[e(O(j),{onClick:q=>ve($,R,g.index),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):D("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):D("",!0)],64))),256))]),_:2},1024)]),_:2},1024)):(r(),h(o,{key:1,onClick:a=>ne($),type:"dashed",size:"large"},{icon:t(()=>[e(O(j),{icon:"tdesign:add"})]),default:t(()=>[b(" 增加匹配条件 ")]),_:2},1032,["onClick"]))]),_:2},1024),e(c,{label:"路由分发",required:""},{default:t(()=>[e(A,null,{default:t(()=>[e(M,{style:{width:"100%"},direction:"vertical",size:"small"},{default:t(()=>[e(v,null,{default:t(()=>[e(c,{label:"匹配条件类型"},{default:t(()=>[e(C,{value:y.selectedRouteDistributeMatchTypes,"onUpdate:value":a=>y.selectedRouteDistributeMatchTypes=a,options:ee.value,mode:"multiple",style:{"min-width":"200px"}},null,8,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1024),(r(!0),W(F,null,Q(y.routeDistribute,(a,R)=>(r(),W(F,{key:R},[y.selectedRouteDistributeMatchTypes.includes("host")&&a.type==="host"?(r(),h(M,{key:0,size:"large",align:"center"},{default:t(()=>[e(K,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:t(()=>[b(z(a==null?void 0:a.type),1)]),_:2},1024),e(C,{value:a.condition,"onUpdate:value":d=>a.condition=d,style:{"min-width":"120px"},options:G.value},null,8,["value","onUpdate:value","options"]),e(s,{value:a.value,"onUpdate:value":d=>a.value=d,placeholder:"请求来源ip"},null,8,["value","onUpdate:value"]),e(O(j),{onClick:d=>oe(a==null?void 0:a.type,$),class:"action-icon",icon:"tdesign:delete"},null,8,["onClick"])]),_:2},1024)):D("",!0),y.selectedRouteDistributeMatchTypes.includes("other")&&a.type==="other"?(r(),h(M,{key:1,style:{width:"100%"},size:"large",align:"start"},{default:t(()=>[e(K,{class:"match-condition-type-label",bordered:!1,color:"processing"},{default:t(()=>[b(z((a==null?void 0:a.type)=="other"?"其他":a==null?void 0:a.type),1)]),_:2},1024),e(M,{direction:"vertical"},{default:t(()=>[e(o,{type:"primary",onClick:d=>he($,R)},{default:t(()=>[b(" 添加其他 ")]),_:2},1032,["onClick"]),e(S,{pagination:!1,columns:Y,"data-source":y.routeDistribute[R].list},{bodyCell:t(({column:d,record:g,text:J,index:q})=>[d.key==="myKey"?(r(),h(s,{key:0,value:g.myKey,"onUpdate:value":T=>g.myKey=T,placeholder:"key"},null,8,["value","onUpdate:value"])):d.key==="condition"?(r(),h(C,{key:1,value:g.condition,"onUpdate:value":T=>g.condition=T,options:G.value},null,8,["value","onUpdate:value","options"])):d.key==="value"?(r(),h(s,{key:2,value:g.value,"onUpdate:value":T=>g.value=T,placeholder:"value"},null,8,["value","onUpdate:value"])):d.key==="operation"?(r(),h(M,{key:3,align:"center"},{default:t(()=>[e(O(j),{onClick:T=>fe($,R,q),icon:"tdesign:remove",class:"action-icon"},null,8,["onClick"])]),_:2},1024)):D("",!0)]),_:2},1032,["data-source"])]),_:2},1024)]),_:2},1024)):D("",!0)],64))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1}),e(o,{onClick:te,type:"primary"},{default:t(()=>[b(" 增加路由")]),_:1})]),_:1})]),_:1})]),_:1},8,["span"]),e(u,{span:P.value?X.value:0,class:"right"},{default:t(()=>[P.value?(r(),h(A,{key:0,class:"sliderBox"},{default:t(()=>[E("div",null,[e(Te,{title:"字段说明",column:1},{default:t(()=>[e(L,{label:"key"},{default:t(()=>[b(" 作用对象"),Se,b(" 可能的值：Dubbo应用名或者服务名 ")]),_:1}),e(L,{label:"scope"},{default:t(()=>[b(" 规则粒度"),Be,b(" 可能的值：application, service ")]),_:1}),e(L,{label:"force"},{default:t(()=>[b(" 容错保护"),Pe,b(" 可能的值：true, false"),We,b(" 描述：如果为true，则路由筛选后若没有可用的地址则会直接报异常；如果为false，则会从可用地址中选择完成RPC调用 ")]),_:1}),e(L,{label:"runtime"},{default:t(()=>[b(" 运行时生效"),Ne,b(" 可能的值：true, false"),Fe,b(" 描述：如果为true，则该rule下的所有路由将会实时生效；若为false，则只有在启动时才会生效 ")]),_:1})]),_:1})])]),_:1})):D("",!0)]),_:1},8,["span"])]),_:1}),e(A,{class:"footer"},{default:t(()=>[e(v,null,{default:t(()=>[e(o,{type:"primary",onClick:Ce},{default:t(()=>[b("确认")]),_:1}),e(o,{style:{"margin-left":"30px"},onClick:l[9]||(l[9]=y=>console.log(i.value))},{default:t(()=>[b(" 取消")]),_:1})]),_:1})]),_:1})])}}}),Xe=ze(Le,[["__scopeId","data-v-f9c27678"]]);export{Xe as default};
