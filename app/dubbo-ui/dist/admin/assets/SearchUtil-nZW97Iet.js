var G=Object.defineProperty;var Q=(d,o,u)=>o in d?G(d,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):d[o]=u;var _=(d,o,u)=>(Q(d,typeof o!="symbol"?o+"":o,u),u);import{d as W,k as Z,r as A,g as q,l as ee,m as te,a as D,f as m,J as g,c as i,t as n,h as s,e as c,P as ae,o as r,x as oe,F as b,y as C,v as y,z as P,B as S,ad as I,I as F,a4 as U,V as se,Y as le,ae as ne,K as re,X as ie,_ as ce}from"./index-WfxyH1kR.js";const ue={class:"__container_search_table"},de={class:"search-query-container"},pe={class:"custom-column button"},_e={class:"dropdown"},me={class:"body"},he=["onClick"],fe={class:"search-table-container"},ge={key:0},ye={key:1},be=W({__name:"SearchTable",setup(d){Z(a=>({"3d09cf76":s(ae)}));const o=A({customColumns:!1}),{appContext:{config:{globalProperties:u}}}=q(),e=ee(te.SEARCH_DOMAIN);e.table.columns.forEach(a=>{if(a.title){const p=a.title;a.title=D(()=>u.$t(p))}});const h=D(()=>e.noPaged?!1:{pageSize:e.paged.pageSize,current:e.paged.curPage,total:e.paged.total,showTotal:a=>u.$t("searchDomain.total")+": "+a+" "+u.$t("searchDomain.unit")}),f=(a,p,v)=>{e.paged.pageSize=a.pageSize,e.paged.curPage=a.current,e.onSearch()};function k(a){let p=e==null?void 0:e.table.columns.filter(v=>!v.__hide);if(!a.__hide&&p.length<=1){ie.warn("must show at least one column");return}a.__hide=!a.__hide}return(a,p)=>{var N,O,V,E;const v=c("a-radio-button"),B=c("a-radio-group"),R=c("a-select-option"),K=c("a-select"),Y=c("a-input"),T=c("a-form-item"),M=c("a-button"),$=c("a-flex"),j=c("a-form"),x=c("a-col"),J=c("a-card"),L=c("a-row"),X=c("a-skeleton-button"),H=c("a-table");return r(),m("div",ue,[g("div",de,[i(L,null,{default:n(()=>[i(x,{span:18},{default:n(()=>[i(j,{onKeyup:p[1]||(p[1]=oe(t=>s(e).onSearch(),["enter"]))},{default:n(()=>[i($,{wrap:"wrap",gap:"large"},{default:n(()=>[(r(!0),m(b,null,C(s(e).params,t=>(r(),y(T,{label:a.$t(t.label)},{default:n(()=>[t.dict&&t.dict.length>0?(r(),m(b,{key:0},[t.dictType==="BUTTON"?(r(),y(B,{key:0,"button-style":"solid",value:s(e).queryForm[t.param],"onUpdate:value":l=>s(e).queryForm[t.param]=l},{default:n(()=>[(r(!0),m(b,null,C(t.dict,l=>(r(),y(v,{value:l.value},{default:n(()=>[P(S(a.$t(l.label)),1)]),_:2},1032,["value"]))),256))]),_:2},1032,["value","onUpdate:value"])):(r(),y(K,{key:1,class:"select-type",style:I(t.style),value:s(e).queryForm[t.param],"onUpdate:value":l=>s(e).queryForm[t.param]=l},{default:n(()=>[(r(!0),m(b,null,C([...t.dict,{label:"none",value:""}],l=>(r(),y(R,{value:l.value},{default:n(()=>[P(S(a.$t(l.label)),1)]),_:2},1032,["value"]))),256))]),_:2},1032,["style","value","onUpdate:value"]))],64)):(r(),y(Y,{key:1,style:I(t.style),placeholder:a.$t("placeholder."+(t.placeholder||"typeDefault")),value:s(e).queryForm[t.param],"onUpdate:value":l=>s(e).queryForm[t.param]=l},null,8,["style","placeholder","value","onUpdate:value"]))]),_:2},1032,["label"]))),256)),i(T,{label:""},{default:n(()=>[i(M,{type:"primary",onClick:p[0]||(p[0]=t=>s(e).onSearch())},{default:n(()=>[i(s(F),{style:{"margin-bottom":"-2px","font-size":"1.3rem"},icon:"ic:outline-manage-search"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i(x,{span:6},{default:n(()=>[i($,{style:{"justify-content":"flex-end"}},{default:n(()=>[U(a.$slots,"customOperation",{},void 0,!0),g("div",{class:"common-tool",onClick:p[2]||(p[2]=t=>o.customColumns=!o.customColumns)},[g("div",pe,[i(s(F),{icon:"material-symbols-light:format-list-bulleted-rounded"})]),se(g("div",_e,[i(J,{style:{"max-width":"300px"},title:"Custom Column"},{default:n(()=>{var t;return[g("div",me,[(r(!0),m(b,null,C((t=s(e))==null?void 0:t.table.columns,(l,w)=>(r(),m("div",{class:"item",onClick:ne(z=>k(l),["stop"])},[i(s(F),{style:{"margin-bottom":"-4px","font-size":"1rem","margin-right":"2px"},icon:l.__hide?"zondicons:view-hide":"zondicons:view-show"},null,8,["icon"]),P(" "+S(l.title),1)],8,he))),256))])]}),_:1})],512),[[le,o.customColumns]])])]),_:3})]),_:3})]),_:3})]),g("div",fe,[i(H,{loading:s(e).table.loading,pagination:h.value,scroll:{scrollToFirstRowOnChange:!0,y:((N=s(e).tableStyle)==null?void 0:N.scrollY)||"",x:((O=s(e).tableStyle)==null?void 0:O.scrollX)||""},columns:(V=s(e))==null?void 0:V.table.columns.filter(t=>!t.__hide),"data-source":(E=s(e))==null?void 0:E.result,onChange:f},{bodyCell:n(({text:t,record:l,index:w,column:z})=>[z.key==="idx"?(r(),m("span",ge,S(w+1),1)):re("",!0),t==="skeleton-loading"?(r(),m("span",ye,[i(X,{active:"",size:"small"})])):U(a.$slots,"bodyCell",{key:2,text:t,record:l,index:w,column:z},void 0,!0)]),_:3},8,["loading","pagination","scroll","columns","data-source"])])])}}}),Se=ce(be,[["__scopeId","data-v-e2b01919"]]);class ke{constructor(o,u,e,h,f,k){_(this,"noPaged");_(this,"queryForm");_(this,"params");_(this,"searchApi");_(this,"result");_(this,"handleResult");_(this,"tableStyle");_(this,"table",{columns:[]});_(this,"paged",{curPage:1,pageOffset:"0",total:0,pageSize:10});this.params=o,this.noPaged=f,this.queryForm=A({}),this.table.columns=e,o.forEach(a=>{a.defaultValue&&(this.queryForm[a.param]=a.defaultValue)}),h&&(this.paged={...this.paged,...h}),this.searchApi=u,this.handleResult=k}async onSearch(o){o&&(this.handleResult=o),this.table.loading=!0,setTimeout(()=>{this.table.loading=!1},1e4);const u={...this.queryForm,...this.noPaged?{}:{pageSize:this.paged.pageSize,pageOffset:(this.paged.curPage-1)*this.paged.pageSize}};try{const e=await this.searchApi(u);if(!e){this.table.loading=!1;return}const{data:{list:h,pageInfo:f}}=e;this.result=o?o(h):h,this.noPaged||(this.paged.total=(f==null?void 0:f.Total)||0)}catch(e){console.error("Error fetching data:",e)}finally{this.table.loading=!1}}}function we(d,o){return isNaN(d-o)?d.localeCompare(o):d-o}export{ke as S,Se as a,we as s};
