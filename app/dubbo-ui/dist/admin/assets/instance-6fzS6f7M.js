import{d as $,k as M,u as B,b as Y,r as w,Q as S,f as I,c as d,t,e as y,h as r,P as h,s as F,M as j,o as a,F as b,y as D,v as l,I as v,z as i,B as o,J as q,K as c,Z as z,$ as H,m as J,_ as K}from"./index-nw_d5X0a.js";import{S as Q,a as U}from"./SearchUtil-xjq24Jx3.js";import{a as G}from"./app-_OEdFWJU.js";import{f as X}from"./DateUtil-hgvfeX8K.js";import{p as Z,q as T}from"./PromQueryUtil-RxWTbbIi.js";import{b as W}from"./ByteUtil-YdHlSEeW.js";import"./request-hwqjhTR7.js";const ee={class:"__container_app_instance"},te={class:"statistic-icon-big"},ae=$({__name:"instance",setup(se){var k;M(n=>({"756f4695":r(h)+"22","9f777f8a":r(h)}));const N=B(),E=Y();let R=w({info:{},report:{}}),O=(k=N.params)==null?void 0:k.pathId;S(async()=>{});const A=[{title:"instanceDomain.ip",dataIndex:"ip",key:"ip",sorter:!0,width:150,fixed:"left"},{title:"instanceDomain.name",dataIndex:"name",key:"name",sorter:!0,width:180},{title:"instanceDomain.deployState",dataIndex:"deployState",key:"deployState",sorter:!0,width:150},{title:"instanceDomain.deployCluster",dataIndex:"deployClusters",key:"deployClusters",sorter:!0,width:180},{title:"instanceDomain.registerState",dataIndex:"registerState",key:"registerState",sorter:!0,width:150},{title:"instanceDomain.registerClusters",dataIndex:"registerCluster",key:"registerCluster",sorter:!0,width:200},{title:"instanceDomain.cpu",dataIndex:"cpu",key:"cpu",sorter:!0,width:120},{title:"instanceDomain.memory",dataIndex:"memory",key:"memory",sorter:!0,width:120},{title:"instanceDomain.startTime",dataIndex:"startTime",key:"startTime",sorter:!0,width:150},{title:"instanceDomain.registerTime",dataIndex:"registerTime",key:"registerTime",sorter:!0,width:150},{title:"instanceDomain.labels",dataIndex:"labels",key:"labels",sorter:!0,fixed:"left",width:800}];function V(n){return G(n).then(async C=>Z(C,["cpu","memory"],async p=>{let u=p.ip.split(":")[0],m=await T(`sum(node_namespace_pod_container:container_cpu_usage_seconds_total:sum_irate{container!=""}) by (pod) * on (pod) group_left(pod_ip)
        kube_pod_info{pod_ip="${u}"}`),g=await T(`sum(container_memory_working_set_bytes{container!=""}) by (pod)
* on (pod) group_left(pod_ip)
kube_pod_info{pod_ip="${u}"}`);p.cpu=F.isNumber(m)?m.toFixed(3)+"u":m,p.memory=W(g)}))}const f=w(new Q([{label:"",param:"type",defaultValue:1,dict:[{label:"ip",value:1},{label:"name",value:2},{label:"label",value:3}],style:{width:"100px"}},{label:"",param:"search",style:{width:"300px"}},{label:"",param:"appName",defaultValue:O,dict:[],dictType:"APPLICATION_NAME"}],V,A,{pageSize:10},!0));S(()=>{f.tableStyle={scrollX:"100",scrollY:"calc(100vh - 400px)"},f.onSearch()});const L=n=>{E.replace(`/resources/instances/detail/${n.split(":")[0]}/${n}`)};return j(J.SEARCH_DOMAIN,f),(n,C)=>{const p=y("a-statistic"),u=y("a-flex"),m=y("a-card"),g=y("a-button"),_=y("a-tag");return a(),I("div",ee,[d(u,{wrap:"wrap",gap:"small",vertical:!1,justify:"space-around",align:"left"},{default:t(()=>[(a(!0),I(b,null,D(r(R).report,(s,e)=>(a(),l(m,{class:"statistic-card"},{default:t(()=>[d(u,{gap:"middle",vertical:!1,justify:"space-between",align:"center"},{default:t(()=>[d(p,{value:s.value,class:"statistic"},{prefix:t(()=>[d(r(v),{class:"statistic-icon",icon:"solar:target-line-duotone"})]),title:t(()=>[i(o(n.$t(e.toString())),1)]),_:2},1032,["value"]),q("div",te,[d(r(v),{icon:s.icon},null,8,["icon"])])]),_:2},1024)]),_:2},1024))),256))]),_:1}),d(U,{"search-domain":f},{bodyCell:t(({column:s,text:e})=>[s.dataIndex==="name"?(a(),l(g,{key:0,type:"link",onClick:x=>L(e)},{default:t(()=>[i(o(e),1)]),_:2},1032,["onClick"])):c("",!0),s.dataIndex==="deployState"?(a(),l(_,{key:1,color:r(z)[e.toUpperCase()]},{default:t(()=>[i(o(e),1)]),_:2},1032,["color"])):c("",!0),s.dataIndex==="deployClusters"?(a(),l(_,{key:2},{default:t(()=>[i(o(e),1)]),_:2},1024)):c("",!0),s.dataIndex==="registerState"?(a(),l(_,{key:3,color:r(H)[e.toUpperCase()]},{default:t(()=>[i(o(e),1)]),_:2},1032,["color"])):c("",!0),s.dataIndex==="registerCluster"?(a(),l(_,{key:4},{default:t(()=>[i(o(e),1)]),_:2},1024)):c("",!0),s.dataIndex==="labels"?(a(!0),I(b,{key:5},D(e,(x,P)=>(a(),l(_,{color:r(h)},{default:t(()=>[i(o(P)+" : "+o(x),1)]),_:2},1032,["color"]))),256)):c("",!0),s.dataIndex==="registerTime"?(a(),I(b,{key:6},[i(o(r(X)(e)),1)],64)):c("",!0)]),_:1},8,["search-domain"])])}}}),pe=K(ae,[["__scopeId","data-v-0646ba5c"]]);export{pe as default};
