var K=Object.defineProperty;var W=(d,o,i)=>o in d?K(d,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):d[o]=i;var p=(d,o,i)=>(W(d,typeof o!="symbol"?o+"":o,i),i);import{d as G,k as Q,r as A,g as Z,l as q,m as ee,a as D,f as h,H as g,c,t as n,h as s,e as u,P as te,o as r,F as y,x as C,v as f,y as P,z as S,ac as I,I as F,a2 as V,U as ae,X as oe,ad as se,W as le,_ as ne}from"./index-ydEeV_dL.js";const re={class:"__container_search_table"},ie={class:"search-query-container"},ce={class:"custom-column button"},ue={class:"dropdown"},de={class:"body"},pe=["onClick"],_e={class:"search-table-container"},me={key:0},he=G({__name:"SearchTable",setup(d){Q(t=>({"11e749a7":s(te)}));const o=A({customColumns:!1}),{appContext:{config:{globalProperties:i}}}=Z(),e=q(ee.SEARCH_DOMAIN);e.table.columns.forEach(t=>{if(t.title){const _=t.title;t.title=D(()=>i.$t(_))}});const m=D(()=>e.noPaged?!1:{pageSize:e.paged.pageSize,current:e.paged.curPage,total:e.paged.total,showTotal:t=>i.$t("searchDomain.total")+": "+t+" "+i.$t("searchDomain.unit")}),w=(t,_,b)=>{e.paged.pageSize=t.pageSize,e.paged.curPage=t.current,e.onSearch()};function v(t){let _=e==null?void 0:e.table.columns.filter(b=>!b.__hide);if(!t.__hide&&_.length<=1){le.warn("must show at least one column");return}t.__hide=!t.__hide}return(t,_)=>{var O,E,N,U;const b=u("a-radio-button"),B=u("a-radio-group"),R=u("a-select-option"),M=u("a-select"),Y=u("a-input"),T=u("a-form-item"),j=u("a-button"),$=u("a-flex"),H=u("a-form"),x=u("a-col"),L=u("a-card"),X=u("a-row"),J=u("a-table");return r(),h("div",re,[g("div",ie,[c(X,null,{default:n(()=>[c(x,{span:18},{default:n(()=>[c(H,null,{default:n(()=>[c($,{wrap:"wrap",gap:"large"},{default:n(()=>[(r(!0),h(y,null,C(s(e).params,a=>(r(),f(T,{label:t.$t(a.label)},{default:n(()=>[a.dict&&a.dict.length>0?(r(),h(y,{key:0},[a.dictType==="BUTTON"?(r(),f(B,{key:0,"button-style":"solid",value:s(e).queryForm[a.param],"onUpdate:value":l=>s(e).queryForm[a.param]=l},{default:n(()=>[(r(!0),h(y,null,C(a.dict,l=>(r(),f(b,{value:l.value},{default:n(()=>[P(S(t.$t(l.label)),1)]),_:2},1032,["value"]))),256))]),_:2},1032,["value","onUpdate:value"])):(r(),f(M,{key:1,class:"select-type",style:I(a.style),value:s(e).queryForm[a.param],"onUpdate:value":l=>s(e).queryForm[a.param]=l},{default:n(()=>[(r(!0),h(y,null,C([...a.dict,{label:"none",value:""}],l=>(r(),f(R,{value:l.value},{default:n(()=>[P(S(t.$t(l.label)),1)]),_:2},1032,["value"]))),256))]),_:2},1032,["style","value","onUpdate:value"]))],64)):(r(),f(Y,{key:1,style:I(a.style),placeholder:t.$t("placeholder."+(a.placeholder||"typeDefault")),value:s(e).queryForm[a.param],"onUpdate:value":l=>s(e).queryForm[a.param]=l},null,8,["style","placeholder","value","onUpdate:value"]))]),_:2},1032,["label"]))),256)),c(T,{label:""},{default:n(()=>[c(j,{type:"primary",onClick:_[0]||(_[0]=a=>s(e).onSearch())},{default:n(()=>[c(s(F),{style:{"margin-bottom":"-2px","font-size":"1.3rem"},icon:"ic:outline-manage-search"})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),c(x,{span:6},{default:n(()=>[c($,{style:{"justify-content":"flex-end"}},{default:n(()=>[V(t.$slots,"customOperation",{},void 0,!0),g("div",{class:"common-tool",onClick:_[1]||(_[1]=a=>o.customColumns=!o.customColumns)},[g("div",ce,[c(s(F),{icon:"material-symbols-light:format-list-bulleted-rounded"})]),ae(g("div",ue,[c(L,{style:{"max-width":"300px"},title:"Custom Column"},{default:n(()=>{var a;return[g("div",de,[(r(!0),h(y,null,C((a=s(e))==null?void 0:a.table.columns,(l,k)=>(r(),h("div",{class:"item",onClick:se(z=>v(l),["stop"])},[c(s(F),{style:{"margin-bottom":"-4px","font-size":"1rem","margin-right":"2px"},icon:l.__hide?"zondicons:view-hide":"zondicons:view-show"},null,8,["icon"]),P(" "+S(l.title),1)],8,pe))),256))])]}),_:1})],512),[[oe,o.customColumns]])])]),_:3})]),_:3})]),_:3})]),g("div",_e,[c(J,{loading:s(e).table.loading,pagination:m.value,scroll:{scrollToFirstRowOnChange:!0,y:((O=s(e).tableStyle)==null?void 0:O.scrollY)||"",x:((E=s(e).tableStyle)==null?void 0:E.scrollX)||""},columns:(N=s(e))==null?void 0:N.table.columns.filter(a=>!a.__hide),"data-source":(U=s(e))==null?void 0:U.result,onChange:w},{bodyCell:n(({text:a,record:l,index:k,column:z})=>[z.key==="idx"?(r(),h("span",me,S(k+1),1)):V(t.$slots,"bodyCell",{key:1,text:a,record:l,index:k,column:z},void 0,!0)]),_:3},8,["loading","pagination","scroll","columns","data-source"])])])}}}),ye=ne(he,[["__scopeId","data-v-ef14b93a"]]);class ve{constructor(o,i,e,m,w,v){p(this,"noPaged");p(this,"queryForm");p(this,"params");p(this,"searchApi");p(this,"result");p(this,"handleResult");p(this,"tableStyle");p(this,"table",{columns:[]});p(this,"paged",{curPage:1,pageOffset:"0",total:0,pageSize:10});this.params=o,this.noPaged=w,this.queryForm=A({}),this.table.columns=e,o.forEach(t=>{t.defaultValue&&(this.queryForm[t.param]=t.defaultValue)}),m&&(this.paged={...this.paged,...m}),this.searchApi=i,v&&this.onSearch(v)}async onSearch(o){this.table.loading=!0,setTimeout(()=>{this.table.loading=!1},5e3);const i={...this.queryForm,...this.noPaged?{}:{pageSize:this.paged.pageSize,pageOffset:(this.paged.curPage-1)*this.paged.pageSize}};try{const{data:{list:e,pageInfo:m}}=await this.searchApi(i);this.result=o?o(e):e,this.noPaged||(this.paged.total=(m==null?void 0:m.Total)||0)}catch(e){console.error("Error fetching data:",e)}this.table.loading=!1}}function be(d,o){return isNaN(d-o)?d.localeCompare(o):d-o}export{ve as S,ye as a,be as s};
