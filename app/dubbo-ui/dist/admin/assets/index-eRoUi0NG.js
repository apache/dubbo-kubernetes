import{d as T,k as N,u as E,r as R,Q as O,w as q,f as y,c as f,t as c,h as u,P as v,s as V,M as A,e as L,o as r,R as P,J as $,I as B,z as d,B as n,K as l,v as _,Z as M,$ as F,F as k,y as x,m as Y,_ as U}from"./index-nw_d5X0a.js";import{s as H}from"./instance-ff1MonXH.js";import{S as J,a as K,s}from"./SearchUtil-xjq24Jx3.js";import{f as Q}from"./DateUtil-hgvfeX8K.js";import{p as z,q as S}from"./PromQueryUtil-RxWTbbIi.js";import{b as G}from"./ByteUtil-YdHlSEeW.js";import"./request-hwqjhTR7.js";const Z={class:"__container_resources_application_index"},j=["onClick"],W=T({__name:"index",setup(X){N(e=>({"552fe430":u(v)}));let g=E(),w=g.query.query,b=[{title:"instanceDomain.instanceIP",key:"ip",dataIndex:"ip",sorter:(e,t)=>s(e.ip,t.ip),width:200},{title:"instanceDomain.instanceName",key:"name",dataIndex:"name",sorter:(e,t)=>s(e.name,t.name),width:140},{title:"instanceDomain.deployState",key:"deployState",dataIndex:"deployState",width:120,sorter:(e,t)=>s(e.deployState,t.deployState)},{title:"instanceDomain.deployCluster",key:"deployCluster",dataIndex:"deployCluster",sorter:(e,t)=>s(e.deployCluster,t.deployCluster),width:120},{title:"instanceDomain.registerState",key:"registerState",dataIndex:"registerState",sorter:(e,t)=>s(e.registerState,t.registerState),width:120},{title:"instanceDomain.registerCluster",key:"registerClusters",dataIndex:"registerClusters",sorter:(e,t)=>s(e.registerClusters,t.registerClusters),width:140},{title:"instanceDomain.CPU",key:"cpu",dataIndex:"cpu",sorter:(e,t)=>s(e.cpu,t.cpu),width:140},{title:"instanceDomain.memory",key:"memory",dataIndex:"memory",sorter:(e,t)=>s(e.memory,t.memory),width:100},{title:"instanceDomain.startTime_k8s",key:"startTime_k8s",dataIndex:"startTime",sorter:(e,t)=>s(e.startTime,t.startTime),width:200},{title:"instanceDomain.registerTime",key:"registerTime",dataIndex:"registerTime",sorter:(e,t)=>s(e.registerTime,t.registerTime),width:200},{title:"instanceDomain.labels",key:"labels",dataIndex:"labels",width:800}];function D(e){return H(e).then(async t=>z(t,["cpu","memory"],async o=>{let a=o.ip.split(":")[0],m=await S(`sum(node_namespace_pod_container:container_cpu_usage_seconds_total:sum_irate{container!=""}) by (pod) * on (pod) group_left(pod_ip)
        kube_pod_info{pod_ip="${a}"}`),I=await S(`sum(container_memory_working_set_bytes{container!=""}) by (pod)
* on (pod) group_left(pod_ip)
kube_pod_info{pod_ip="${a}"}`);o.cpu=V.isNumber(m)?m.toFixed(3)+"u":m,o.memory=G(I)}))}const p=R(new J([{label:"appName",param:"keywords",defaultValue:w,placeholder:"typeAppName",style:{width:"200px"}}],D,b));return O(()=>{p.tableStyle={scrollY:"calc(100vh - 400px)"},p.onSearch()}),A(Y.SEARCH_DOMAIN,p),q(g,(e,t)=>{p.queryForm.keywords=e.query.query,p.onSearch(),console.log(e)}),(e,t)=>{const o=L("a-tag");return r(),y("div",Z,[f(K,{"search-domain":p},{bodyCell:c(({text:a,record:m,index:I,column:i})=>[i.dataIndex==="ip"?(r(),y("span",{key:0,class:"app-link",onClick:h=>u(P).push(`/resources/instances/detail/${m[i.key]}/${m.name}`)},[$("b",null,[f(u(B),{style:{"margin-bottom":"-2px"},icon:"material-symbols:attach-file-rounded"}),d(" "+n(a),1)])],8,j)):l("",!0),i.dataIndex==="deployState"?(r(),_(o,{key:1,color:u(M)[a.toUpperCase()]},{default:c(()=>[d(n(a),1)]),_:2},1032,["color"])):l("",!0),i.dataIndex==="deployCluster"?(r(),_(o,{key:2,color:"grey"},{default:c(()=>[d(n(a),1)]),_:2},1024)):l("",!0),i.dataIndex==="registerState"?(r(),_(o,{key:3,color:u(F)[a.toUpperCase()]},{default:c(()=>[d(n(a),1)]),_:2},1032,["color"])):l("",!0),i.dataIndex==="registerClusters"?(r(!0),y(k,{key:4},x(a,h=>(r(),_(o,{color:"grey"},{default:c(()=>[d(n(h),1)]),_:2},1024))),256)):l("",!0),i.dataIndex==="registerTime"?(r(),y(k,{key:5},[d(n(u(Q)(a)),1)],64)):l("",!0),i.dataIndex==="labels"?(r(!0),y(k,{key:6},x(a,(h,C)=>(r(),_(o,{key:C},{default:c(()=>[d(n(C)+":"+n(h),1)]),_:2},1024))),128)):l("",!0)]),_:1},8,["search-domain"])])}}}),ne=U(W,[["__scopeId","data-v-6093a368"]]);export{ne as default};
