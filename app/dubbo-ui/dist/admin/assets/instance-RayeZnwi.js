import{d as $,k as M,u as B,b as Y,r as w,Q as S,f as I,c as d,t,e as y,h as r,P as b,s as F,M as j,o as a,F as g,y as D,v as l,I as v,z as n,B as o,J as q,K as c,Z as z,$ as H,m as J,_ as K}from"./index-3yaHMBuR.js";import{S as Q,a as U}from"./SearchUtil-x3tT_5M1.js";import{a as G}from"./app-3RL8xbzR.js";import{f as X}from"./DateUtil-4kBRTJms.js";import{p as Z,q as N}from"./PromQueryUtil-LZegKrD1.js";import{b as W}from"./ByteUtil-YdHlSEeW.js";import"./request-8fqjBntA.js";const ee={class:"__container_app_instance"},te={class:"statistic-icon-big"},ae=$({__name:"instance",setup(se){var k;M(i=>({"4b565263":r(b)+"22","7b2014ad":r(b)}));const T=B(),E=Y();let R=w({info:{},report:{}}),O=(k=T.params)==null?void 0:k.pathId;S(async()=>{});const A=[{title:"instanceDomain.ip",dataIndex:"ip",key:"ip",sorter:!0,width:150,fixed:"left"},{title:"instanceDomain.name",dataIndex:"name",key:"name",sorter:!0,width:180},{title:"instanceDomain.deployState",dataIndex:"deployState",key:"deployState",sorter:!0,width:150},{title:"instanceDomain.deployCluster",dataIndex:"deployClusters",key:"deployClusters",sorter:!0,width:180},{title:"instanceDomain.registerState",dataIndex:"registerState",key:"registerState",sorter:!0,width:150},{title:"instanceDomain.registerClusters",dataIndex:"registerCluster",key:"registerCluster",sorter:!0,width:200},{title:"instanceDomain.cpu",dataIndex:"cpu",key:"cpu",sorter:!0,width:120},{title:"instanceDomain.memory",dataIndex:"memory",key:"memory",sorter:!0,width:120},{title:"instanceDomain.startTime",dataIndex:"startTime",key:"startTime",sorter:!0,width:150}];function V(i){return G(i).then(async C=>Z(C,["cpu","memory"],async p=>{let u=p.ip.split(":")[0],_=await N(`sum(node_namespace_pod_container:container_cpu_usage_seconds_total:sum_irate{container!=""}) by (pod) * on (pod) group_left(pod_ip)
        kube_pod_info{pod_ip="${u}"}`),h=await N(`sum(container_memory_working_set_bytes{container!=""}) by (pod)
* on (pod) group_left(pod_ip)
kube_pod_info{pod_ip="${u}"}`);p.cpu=F.isNumber(_)?_.toFixed(3)+"u":_,p.memory=W(h)}))}const f=w(new Q([{label:"",param:"type",defaultValue:1,dict:[{label:"ip",value:1},{label:"name",value:2},{label:"label",value:3}],style:{width:"100px"}},{label:"",param:"search",style:{width:"300px"}},{label:"",param:"appName",defaultValue:O,dict:[],dictType:"APPLICATION_NAME"}],V,A,{pageSize:10},!0));S(()=>{f.tableStyle={scrollX:"100",scrollY:"calc(100vh - 400px)"},f.onSearch()});const L=i=>{E.replace(`/resources/instances/detail/${i.split(":")[0]}/${i}`)};return j(J.SEARCH_DOMAIN,f),(i,C)=>{const p=y("a-statistic"),u=y("a-flex"),_=y("a-card"),h=y("a-button"),m=y("a-tag");return a(),I("div",ee,[d(u,{wrap:"wrap",gap:"small",vertical:!1,justify:"space-around",align:"left"},{default:t(()=>[(a(!0),I(g,null,D(r(R).report,(s,e)=>(a(),l(_,{class:"statistic-card"},{default:t(()=>[d(u,{gap:"middle",vertical:!1,justify:"space-between",align:"center"},{default:t(()=>[d(p,{value:s.value,class:"statistic"},{prefix:t(()=>[d(r(v),{class:"statistic-icon",icon:"solar:target-line-duotone"})]),title:t(()=>[n(o(i.$t(e.toString())),1)]),_:2},1032,["value"]),q("div",te,[d(r(v),{icon:s.icon},null,8,["icon"])])]),_:2},1024)]),_:2},1024))),256))]),_:1}),d(U,{"search-domain":f},{bodyCell:t(({column:s,text:e})=>[s.dataIndex==="name"?(a(),l(h,{key:0,type:"link",onClick:x=>L(e)},{default:t(()=>[n(o(e),1)]),_:2},1032,["onClick"])):c("",!0),s.dataIndex==="deployState"?(a(),l(m,{key:1,color:r(z)[e.toUpperCase()]},{default:t(()=>[n(o(e),1)]),_:2},1032,["color"])):c("",!0),s.dataIndex==="deployClusters"?(a(),l(m,{key:2},{default:t(()=>[n(o(e),1)]),_:2},1024)):c("",!0),s.dataIndex==="registerState"?(a(),l(m,{key:3,color:r(H)[e.toUpperCase()]},{default:t(()=>[n(o(e),1)]),_:2},1032,["color"])):c("",!0),s.dataIndex==="registerCluster"?(a(),l(m,{key:4},{default:t(()=>[n(o(e),1)]),_:2},1024)):c("",!0),s.dataIndex==="labels"?(a(!0),I(g,{key:5},D(e,(x,P)=>(a(),l(m,{color:r(b)},{default:t(()=>[n(o(P)+" : "+o(x),1)]),_:2},1032,["color"]))),256)):c("",!0),s.dataIndex==="registerTime"?(a(),I(g,{key:6},[n(o(r(X)(e)),1)],64)):c("",!0)]),_:1},8,["search-domain"])])}}}),pe=K(ae,[["__scopeId","data-v-de9e0d35"]]);export{pe as default};
